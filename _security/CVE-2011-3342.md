---
name: CVE-2011-3342
description: Buffer overflows in savegame loading
first_vulnerable: 0.1.0
first_fixed: 1.1.3
related_bugs:
- 4748
- 4717
related_commits:
- 81074e0
- ef09794
patches:
- name: For version 1.1.2 up to including 1.1.2
  file: 1.1.2 - 1.1.2.patch
- name: For version 1.1.0 up to including 1.1.1
  file: 1.1.0 - 1.1.1.patch
- name: For version 1.0.5 up to including 1.0.5
  file: 1.0.5 - 1.0.5.patch
- name: For version 0.7.0 up to including 0.7.5
  file: 0.7.0 - 0.7.5.patch
- name: For version 0.6.0 up to including 0.6.3
  file: 0.6.0 - 0.6.3.patch
- name: For version 0.5.0 up to including 0.5.3
  file: 0.5.0 - 0.5.3.patch
- name: For version 1.0.0 up to including 1.0.4
  file: 1.0.0 - 1.0.4.patch
---

In multiple places indices in savegames are not properly validated that allow 
(remote) attackers to cause a denial of service (crash) and possibly execute 
arbitrary code via unspecified vectors.

The bug is exploitable by passing someone a modified savegame, be it via a file
sharing site, or by running a server. In case of the server the user only has
to be able to login into the server, which is easy to accomplish: set no server
password and do not ban anyone. Then upon joining the server the savegame
will be downloaded and subsequently loaded.

Note that versions before 0.5.0 are vulnerable as well. However, these versions
are over five years old and not supported anymore. Therefore no patches for
earlier versions are provided. Before 0.3.5 it is not possible to exploit this
bug via the internet as multiplayer over internet did not exist yet.