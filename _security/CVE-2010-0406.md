---
name: CVE-2010-0406
description: Denial of service (server) via leaking file descriptors
first_vulnerable: 0.3.5
first_fixed: 1.0.1
related_bugs:
- 3785
related_commits:
- 26af87b
patches:
- name: For version 0.6.0 up to including 1.0.0
  file: 0.6.0 - 1.0.0.patch
- name: For version 0.3.5 up to including 0.5.3
  file: 0.3.5 - 0.5.3.patch
---

Upon a client downloading the map from the server a file is allocated. If this
download fails for any reason at the client side, e.g. lost connection or the
player cancelling the download, a file descriptor is lost.

Repeating this process enough times can cause OpenTTD to run out of file
descriptors and as a result crash OpenTTD.

The attached patches do not change network compatability at all.
