---
layout: security_patch
cve: CVE-2005-2763
first_version: 0.3.5
last_version: 0.3.5
---

Index: network_client.c
===================================================================
--- network_client.c
+++ network_client.c
@@ -344,7 +344,7 @@
 	if (ci != NULL) {
 		if (playas == ci->client_playas && strcmp(name, ci->client_name) != 0) {
 			// Client name changed, display the change
-			NetworkTextMessage(NETWORK_ACTION_NAME_CHANGE, 1, false, ci->client_name, name);
+			NetworkTextMessage(NETWORK_ACTION_NAME_CHANGE, 1, false, ci->client_name, "%s", name);
 		} else if (playas != ci->client_playas) {
 			// The player changed from client-player..
 			// Do not display that for now
@@ -687,7 +687,7 @@

 	ci = NetworkFindClientInfoFromIndex(index);
 	if (ci != NULL) {
-		NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, ci->client_name, str);
+		NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, ci->client_name, "%s", str);

 		// The client is gone, give the NetworkClientInfo free
 		ci->client_index = NETWORK_EMPTY_INDEX;
Index: console_cmds.c
===================================================================
--- console_cmds.c
+++ console_cmds.c
@@ -706,7 +706,7 @@
 				SEND_COMMAND(PACKET_CLIENT_SET_NAME)(argv[2]);
 			else {
 				if (NetworkFindName(argv[2])) {
-					NetworkTextMessage(NETWORK_ACTION_NAME_CHANGE, 1, false, ci->client_name, argv[2]);
+					NetworkTextMessage(NETWORK_ACTION_NAME_CHANGE, 1, false, ci->client_name, "%s", argv[2]);
 					ttd_strlcpy(ci->client_name, argv[2], sizeof(ci->client_name));
 					NetworkUpdateClientInfo(NETWORK_SERVER_INDEX);
 				}
Index: network_server.c
===================================================================
--- network_server.c
+++ network_server.c
@@ -936,7 +936,7 @@

 	NetworkGetClientName(client_name, sizeof(client_name), cs);

-	NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, client_name, str);
+	NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, client_name, "%s", str);

 	FOR_ALL_CLIENTS(new_cs) {
 		if (new_cs->status > STATUS_AUTH) {
@@ -1111,7 +1111,7 @@
 	if (ci != NULL) {
 		// Display change
 		if (NetworkFindName(client_name)) {
-			NetworkTextMessage(NETWORK_ACTION_NAME_CHANGE, 1, false, ci->client_name, client_name);
+			NetworkTextMessage(NETWORK_ACTION_NAME_CHANGE, 1, false, ci->client_name, "%s", client_name);
 			ttd_strlcpy(ci->client_name, client_name, sizeof(ci->client_name));
 			NetworkUpdateClientInfo(ci->client_index);
 		}
