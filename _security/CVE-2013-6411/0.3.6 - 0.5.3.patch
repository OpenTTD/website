---
layout: security_patch
cve: CVE-2013-6411
first_version: 0.3.6
last_version: 0.5.3
---

Index: aircraft_cmd.c
===================================================================
--- aircraft_cmd.c	(revision 25160)
+++ aircraft_cmd.c	(working copy)
@@ -1102,7 +1102,7 @@
 
 	// make aircraft crash down to the ground
 	if (v->u.air.crashed_counter < 500 && st->airport_tile==0 && ((v->u.air.crashed_counter % 3) == 0) ) {
-		z = GetSlopeZ(v->x_pos, v->y_pos);
+		z = GetSlopeZ(clamp(v->x_pos, 0, MapMaxX() * TILE_SIZE), clamp(v->y_pos, 0, MapMaxY() * TILE_SIZE));
 		v->z_pos -= 1;
 		if (v->z_pos == z) {
 			v->u.air.crashed_counter = 500;
