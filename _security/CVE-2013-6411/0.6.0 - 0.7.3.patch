---
layout: security_patch
cve: CVE-2013-6411
first_version: 0.6.0
last_version: 0.7.3
---

Index: src/aircraft_cmd.cpp
===================================================================
--- src/aircraft_cmd.cpp	(revision 25754)
+++ src/aircraft_cmd.cpp	(working copy)
@@ -1157,7 +1157,7 @@
 
 	/* make aircraft crash down to the ground */
 	if (v->u.air.crashed_counter < 500 && st == NULL && ((v->u.air.crashed_counter % 3) == 0) ) {
-		uint z = GetSlopeZ(v->x_pos, v->y_pos);
+		uint z = GetSlopeZ(Clamp(v->x_pos, 0, MapMaxX() * TILE_SIZE), Clamp(v->y_pos, 0, MapMaxY() * TILE_SIZE));
 		v->z_pos -= 1;
 		if (v->z_pos == z) {
 			v->u.air.crashed_counter = 500;
