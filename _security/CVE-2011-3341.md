---
name: CVE-2011-3341
description: Denial of service via improperly validated commands
first_vulnerable: 0.3.5
first_fixed: 1.1.3
related_bugs:
- 4745
related_commits:
- 4836a6e
patches:
- name: For version 1.1.0 up to including 1.1.2
  file: 1.1.0 - 1.1.2.patch
- name: For version 1.0.1 up to including 1.0.5
  file: 1.0.1 - 1.0.5.patch
- name: For version 1.0.0 up to including 1.0.0
  file: 1.0.0 - 1.0.0.patch
- name: For version 0.7.0 up to including 0.7.5
  file: 0.7.0 - 0.7.5.patch
- name: For version 0.6.0 up to including 0.6.3
  file: 0.6.0 - 0.6.3.patch
- name: For version 0.3.5 up to including 0.5.3
  file: 0.3.5 - 0.5.3.patch
---

In multiple places in-game commands are not properly validated that allow remote 
attackers to cause a denial of service (crash) and possibly execute arbitrary 
code via unspecified vectors.

The bug is exploitable only in-game so the attacker must have access to the 
server: his IP must not be banned, he must know the password if it has been set 
and the server must not be full.

The major cause of these bugs are off-by-one errors in the validation of the 
sent commands from the clients to the server, and from the server to the client. 
One could therefore, in theory, affect both the server and the clients of that 
server.

Two of the cases (since 0.7.0) are known to make the game state invalid, which 
causes an eventual crash of the application via an "abort()". Two cases cause a 
read beyond the boundaries of a (static) table (resp. since 0.3.5 and 1.0.0). 
The last case allows changes to the game state of others that might trigger 
invalid reads for other players if they had the autoreplace window opened (since 
0.6.0).