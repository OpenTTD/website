---
layout: security_patch
cve: CVE-2011-3341
first_version: 0.6.0
last_version: 0.6.3
---

Index: src/network/network_data.cpp
===================================================================
--- src/network/network_data.cpp	(revision 22703)
+++ src/network/network_data.cpp	(working copy)
@@ -96,7 +96,7 @@
 	_current_player = cp->player;
 	_cmd_text = cp->text;
 	/* cp->callback is unsigned. so we don't need to do lower bounds checking. */
-	if (cp->callback > _callback_table_count) {
+	if (cp->callback >= _callback_table_count) {
 		DEBUG(net, 0, "Received out-of-bounds callback (%d)", cp->callback);
 		cp->callback = 0;
 	}
Index: src/players.cpp
===================================================================
--- src/players.cpp	(revision 22703)
+++ src/players.cpp	(working copy)
@@ -703,7 +703,7 @@
 			GroupID id_g = GB(p1, 16, 16);
 			CommandCost cost;
 
-			if (!IsValidGroupID(id_g) && !IsAllGroupID(id_g) && !IsDefaultGroupID(id_g)) return CMD_ERROR;
+			if (IsValidGroupID(id_g) ? GetGroup(id_g)->owner != _current_company : !IsAllGroupID(id_g) && !IsDefaultGroupID(id_g)) return CMD_ERROR;
 			if (new_engine_type != INVALID_ENGINE) {
 				/* First we make sure that it's a valid type the user requested
 				 * check that it's an engine that is in the engine array */
