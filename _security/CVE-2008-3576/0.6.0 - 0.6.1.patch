---
layout: security_patch
cve: CVE-2008-3576
first_version: 0.6.0
last_version: 0.6.1
---

Index: src/gfx.cpp
===================================================================
--- src/gfx.cpp
+++ src/gfx.cpp
@@ -256,9 +256,10 @@
 			w += GetCharacterWidth(size, c);

 			if (w >= maxw) {
-				/* string got too big... insert dotdotdot */
-				ddd_pos[0] = ddd_pos[1] = ddd_pos[2] = '.';
-				ddd_pos[3] = '\0';
+				/* string got too big... insert dotdotdot, but make sure we do not
+				 * print anything beyond the string termination character. */
+				for (int i = 0; *ddd_pos != '\0' && i < 3; i++, ddd_pos++) *ddd_pos = '.';
+				*ddd_pos = '\0';
 				return ddd_w;
 			}
 		} else {

