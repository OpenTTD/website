---
layout: security_patch
cve: CVE-2011-3343
first_version: 0.4.5
last_version: 0.4.8
---

diff --git sound.c sound.c
index 4e3a463..1bd1616 100644
--- sound.c
+++ sound.c
@@ -109,7 +109,8 @@ static bool SetBankSource(MixerChannel *mc, uint bank)
 	if (bank >= _file_count) return false;
 	fe = &_files[bank];
 
-	if (fe->file_size == 0) return false;
+	/* Check for valid sound size. */
+	if (fe->file_size == 0 || fe->file_size > ((size_t)-1) - 2) return false;
 
 	mem = malloc(fe->file_size);
 	if (mem == NULL) return false;
