---
layout: security_patch
cve: CVE-2011-3343
first_version: 0.3.1
last_version: 0.4.0.1
---

diff --git sound.c sound.c
index 4d87d8f..cec54e6 100644
--- sound.c
+++ sound.c
@@ -92,7 +92,7 @@ static bool SetBankSource(MixerChannel *mc, uint bank)
 	int8 *mem;
 	uint i;
 
-	if (fe->file_size == 0)
+	if (fe->file_size == 0 || fe->file_size > ((size_t)-1) - 2)
 		return false;
 
 	mem = malloc(fe->file_size); /* XXX unchecked malloc */
